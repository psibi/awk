<!doctype html>
<html lang="en">
<head>
<title></title>
<!-- 2020-11-24 Tue 20:07 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Org-mode">
<meta name="author" content="Sibi Prabakaran">

<link  href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
<style>
/* org mode styles on top of twbs */

html {
    position: relative;
    min-height: 100%;
}

body {
    font-size: 18px;
    margin-bottom: 105px;
}

footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 101px;
    background-color: #f5f5f5;
}

footer > div {
    padding: 10px;
}

footer p {
    margin: 0 0 5px;
    text-align: center;
    font-size: 16px;
}

#table-of-contents {
    margin-top: 20px;
    margin-bottom: 20px;
}

blockquote p {
    font-size: 18px;
}

pre {
    font-size: 16px;
}

.footpara {
    display: inline-block;
}

figcaption {
  font-size: 16px;
  color: #666;
  font-style: italic;
  padding-bottom: 15px;
}

/* from twbs docs */

.bs-docs-sidebar.affix {
    position: static;
}
@media (min-width: 768px) {
    .bs-docs-sidebar {
        padding-left: 20px;
    }
}

/* All levels of nav */
.bs-docs-sidebar .nav > li > a {
    display: block;
    padding: 4px 20px;
    font-size: 14px;
    font-weight: 500;
    color: #999;
}
.bs-docs-sidebar .nav > li > a:hover,
.bs-docs-sidebar .nav > li > a:focus {
    padding-left: 19px;
    color: #A1283B;
    text-decoration: none;
    background-color: transparent;
    border-left: 1px solid #A1283B;
}
.bs-docs-sidebar .nav > .active > a,
.bs-docs-sidebar .nav > .active:hover > a,
.bs-docs-sidebar .nav > .active:focus > a {
    padding-left: 18px;
    font-weight: bold;
    color: #A1283B;
    background-color: transparent;
    border-left: 2px solid #A1283B;
}

/* Nav: second level (shown on .active) */
.bs-docs-sidebar .nav .nav {
    display: none; /* Hide by default, but at >768px, show it */
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 30px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav > li > a:focus {
    padding-left: 29px;
}
.bs-docs-sidebar .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav > .active:focus > a {
    padding-left: 28px;
    font-weight: 500;
}

/* Nav: third level (shown on .active) */
.bs-docs-sidebar .nav .nav .nav {
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 40px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav .nav > li > a:focus {
    padding-left: 39px;
}
.bs-docs-sidebar .nav .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav .nav > .active:focus > a {
    padding-left: 38px;
    font-weight: 500;
}

/* Show and affix the side nav when space allows it */
@media (min-width: 992px) {
    .bs-docs-sidebar .nav > .active > ul {
        display: block;
    }
    /* Widen the fixed sidebar */
    .bs-docs-sidebar.affix,
    .bs-docs-sidebar.affix-bottom {
        width: 213px;
    }
    .bs-docs-sidebar.affix {
        position: fixed; /* Undo the static from mobile first approach */
        top: 20px;
    }
    .bs-docs-sidebar.affix-bottom {
        position: absolute; /* Undo the static from mobile first approach */
    }
    .bs-docs-sidebar.affix .bs-docs-sidenav,.bs-docs-sidebar.affix-bottom .bs-docs-sidenav {
        margin-top: 0;
        margin-bottom: 0
    }
}
@media (min-width: 1200px) {
    /* Widen the fixed sidebar again */
    .bs-docs-sidebar.affix-bottom,
    .bs-docs-sidebar.affix {
        width: 263px;
    }
}
</style>
<script>
$(function() {
    'use strict';

    $('.bs-docs-sidebar li').first().addClass('active');

    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    $('.bs-docs-sidebar').affix();
});
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="https://psibi.in/awk/"> UP </a>
 |
 <a accesskey="H" href="https://psibi.in/"> HOME </a>
</div><div id="content" class="container">
<div class="row"><div class="col-md-3 col-md-push-9"><nav id="table-of-contents">
<div id="text-table-of-contents" class="bs-docs-sidebar">
<ul class="nav">
<li><a href="#sec-1">1. An AWK Tutorial</a></li>
<li><a href="#sec-2">2. Getting started</a>
<ul class="nav">
<li><a href="#sec-2-1">2.1. Employees who worked more than zero hours</a></li>
<li><a href="#sec-2-2">2.2. Employees who didn't work</a></li>
</ul>
</li>
<li><a href="#sec-3">3. The Structure of an AWK Program</a></li>
<li><a href="#sec-4">4. Running an AWK Program</a></li>
<li><a href="#sec-5">5. Errors</a></li>
<li><a href="#sec-6">6. Simple output</a>
<ul class="nav">
<li><a href="#sec-6-1">6.1. Printing Every line</a></li>
<li><a href="#sec-6-2">6.2. Printing Certain Fields</a></li>
<li><a href="#sec-6-3">6.3. NF, the Number of Fields</a></li>
<li><a href="#sec-6-4">6.4. Computing and Printing</a></li>
<li><a href="#sec-6-5">6.5. Printing Line Numbers</a></li>
<li><a href="#sec-6-6">6.6. Printing Text in the Output</a></li>
</ul>
</li>
<li><a href="#sec-7">7. Fancier Output</a>
<ul class="nav">
<li><a href="#sec-7-1">7.1. Lining up Fields</a></li>
<li><a href="#sec-7-2">7.2. Sorting the Output</a></li>
</ul>
</li>
<li><a href="#sec-8">8. Selection</a>
<ul class="nav">
<li><a href="#sec-8-1">8.1. Selection by Comparison</a></li>
<li><a href="#sec-8-2">8.2. Selection by Computation</a></li>
<li><a href="#sec-8-3">8.3. Selection by Text Content</a></li>
<li><a href="#sec-8-4">8.4. Combinations of Patterns</a></li>
<li><a href="#sec-8-5">8.5. Data validation</a></li>
<li><a href="#sec-8-6">8.6. BEGIN and END</a></li>
</ul>
</li>
<li><a href="#sec-9">9. Computing with AWK</a>
<ul class="nav">
<li><a href="#sec-9-1">9.1. Computing Sums and Averages</a></li>
<li><a href="#sec-9-2">9.2. Handling Text</a></li>
<li><a href="#sec-9-3">9.3. String Concatenation</a></li>
<li><a href="#sec-9-4">9.4. Printing the Last Input Line</a></li>
<li><a href="#sec-9-5">9.5. Built-in functions</a></li>
<li><a href="#sec-9-6">9.6. Counting Lines, Words and Characters</a></li>
</ul>
</li>
<li><a href="#sec-10">10. Control-Flow Statements</a>
<ul class="nav">
<li><a href="#sec-10-1">10.1. If-Else Statement</a></li>
<li><a href="#sec-10-2">10.2. While Statement</a></li>
<li><a href="#sec-10-3">10.3. For Statement</a></li>
</ul>
</li>
<li><a href="#sec-11">11. Arrays</a></li>
<li><a href="#sec-12">12. A Handful of Useful "One-liners"</a></li>
</ul>
</div>
</nav>
</div><div class="col-md-9 col-md-pull-3"><h1 class="title"></h1>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> An AWK Tutorial</h2>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Getting started</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>Awk is a convenient and expressive programming language that can be
applied to a wide variety of computing and data-manipulation tasks.
</li>
<li><b>emp.data</b> will be used to explore further
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sh">bat emp.data
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Dan</td>
<td class="text-right">3.75</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>First column: Employee name
</li>
<li>Second column: Pay rate in dollars per hour
</li>
<li>Third column: Number of hours worked
</li>
</ul>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Employees who worked more than zero hours</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-awk">$3 &gt; 0 { print $1, $2 * $3} 
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Kathy</td>
<td class="text-right">40</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">100</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">121</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">76.5</td>
</tr>
</tbody>
</table>

<p>
Note that the above command in a CLI will be invoked like this:
</p>

<pre class="example">
$ awk '$3 &gt; 0 { print $1, $2 * $3}' emp.data
</pre>

<ul class="org-ul">
<li>But in this document we will just concentrate on it's language. The
part inside the quotes is the complete awk program. It consists of a
single <b>pattern action statement</b>.
</li>
<li>The pattern <code>$3 &gt; 0$</code> matches every input line in which the third
column or field is greater than zero and executes the corresponding
action.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Employees who didn't work</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-awk">$3 == 0 { print $1 }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
</tr>

<tr>
<td class="text-left">Dan</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> The Structure of an AWK Program</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>Each awk program is a sequence of one or more pattern action
statements:
</li>
</ul>

<pre class="example">
pattern { action }
pattern { action }
...
</pre>

<ul class="org-ul">
<li>The basic operation of awk is to scan a sequence of input lines one
after another, searching for lines that are matched by any of the
patterns in the program. The precise meaning of the word "match"
depends on the pattern.
</li>
<li>Every input line is tested against each of the patterns in turn. For
each pattern that matches, the corresponding action is performed.
</li>
<li>If the pattern has no action, then each line that the pattern
matches is printed:
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$3 == 0
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Dan</td>
<td class="text-right">3.75</td>
<td class="text-right">0</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>If there is an action with no pattern, then for each line the action
is performed:
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">{ print $1 }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
</tr>

<tr>
<td class="text-left">Dan</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
</tr>

<tr>
<td class="text-left">Mark</td>
</tr>

<tr>
<td class="text-left">Mary</td>
</tr>

<tr>
<td class="text-left">Susie</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Running an AWK Program</h2>
<div class="outline-text-2" id="text-4">
<p>
Several ways:
</p>

<pre class="example">
$ aws 'program' files
$ aws '$3 == 0 { print $1}' file1 file2
</pre>

<p>
Or you can supply input via stdin:
</p>

<pre class="example">
$ awk 'program'
</pre>

<p>
It accepts input till the end-of-file signal. (Ctrl-D on Unix). The
stdin way of doing will be quite handy to experiment. If your awk
program is long, you can pass the program explicitly:
</p>

<pre class="example">
$ awk -f progfile input files
</pre>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Errors</h2>
<div class="outline-text-2" id="text-5">
<p>
Awk will report an error if there is an error in the code
(duh!). Let's mistype a brace:
</p>

<pre class="example">
$ awk '$3 == 0 [ print $1 }' emp.dat
awk: line 1: syntax error at or near [
awk: line 1: extra '}'
</pre>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> Simple output</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>There are only two types of data in awk: numbers and string of
characters.
</li>
<li>Awk reads its input one line at a time and splits each line into
fields, where, by default, a field is a sequence of characters that
doesn't contain any blanks or tabs. The first field in the current
input line is called $1, the second $2, and so forth. The entire
line is called $0. The number of fields can vary from line to line.
</li>
</ul>
</div>

<div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> Printing Every line</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">

<pre class="src src-awk">{ print }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Dan</td>
<td class="text-right">3.75</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>

<p>
Or even this:
</p>

<div class="org-src-container">

<pre class="src src-awk">{ print $0 }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Dan</td>
<td class="text-right">3.75</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> Printing Certain Fields</h3>
<div class="outline-text-3" id="text-6-2">
<div class="org-src-container">

<pre class="src src-awk">{ print $1, $3 }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Dan</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Expressions separated by a comma in a print statement are, by
default, separated by a single blank when they are printed.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3"><span class="section-number-3">6.3</span> NF, the Number of Fields</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>Awk counts the number of fields in the current input line and stores
the count in a built-in variable called <code>NF</code>.
</li>
<li>Any expression can be used after <code>$</code> to denote a field number; the
expression is evaluated and its numberic value is used as the field
number.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">{ print NF, $1, $NF }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="right">

<col  class="left">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-right">3</td>
<td class="text-left">Beth</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-right">3</td>
<td class="text-left">Dan</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-right">3</td>
<td class="text-left">Kathy</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-right">3</td>
<td class="text-left">Mark</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-right">3</td>
<td class="text-left">Mary</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-right">3</td>
<td class="text-left">Susie</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4"><span class="section-number-3">6.4</span> Computing and Printing</h3>
<div class="outline-text-3" id="text-6-4">
<div class="org-src-container">

<pre class="src src-awk">{ print $1, $2 * $3 }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Dan</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">40</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">100</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">121</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">76.5</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5"><span class="section-number-3">6.5</span> Printing Line Numbers</h3>
<div class="outline-text-3" id="text-6-5">
<ul class="org-ul">
<li>Awk provides another built-variable, called <b>NR</b>, that counts the
number of lines read so far.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">{ print NR, $0 }
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="right">

<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-right">1</td>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-right">2</td>
<td class="text-left">Dan</td>
<td class="text-right">3.75</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-right">3</td>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-right">4</td>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-right">5</td>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-right">6</td>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-6-6" class="outline-3">
<h3 id="sec-6-6"><span class="section-number-3">6.6</span> Printing Text in the Output</h3>
<div class="outline-text-3" id="text-6-6">
<div class="org-src-container">

<pre class="src src-awk">{ print "total pay for", $1, "is", $2 * $3 }
</pre>
</div>

<pre class="example">
total pay for Beth is 0
total pay for Dan is 0
total pay for Kathy is 40
total pay for Mark is 100
total pay for Mary is 121
total pay for Susie is 76.5
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> Fancier Output</h2>
<div class="outline-text-2" id="text-7">
<ul class="org-ul">
<li>The <b>print</b> statement is meant for quick and easy output.
</li>
<li>To format the output exactly the way you want it, you may have to
use the <b>printf</b> statement.
</li>
</ul>
</div>

<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> Lining up Fields</h3>
<div class="outline-text-3" id="text-7-1">
<pre class="example">
printf(format, value_1, value_2, ... , value_n)
</pre>

<ul class="org-ul">
<li>format: is a string that contains text to be printed verbatim,
interspered with specifications of how each of the values is to be
printed.
</li>
<li>A specification is a <code>%</code> followed by a few characters that control
the format of a value.
</li>
<li>Thus, there must be as many <code>%</code> specifications in format as values to
be printed.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">{ printf("total pay for %s is $%.2f\n", $1, $2 * $3) }
</pre>
</div>

<pre class="example">
total pay for Beth is $0.00
total pay for Dan is $0.00
total pay for Kathy is $40.00
total pay for Mark is $100.00
total pay for Mary is $121.00
total pay for Susie is $76.50
</pre>


<ul class="org-ul">
<li><code>%s</code>: Specifices that the first value is a string of characters.
</li>
<li><code>%.2f</code>: Specifices that the second value (<code>$2*$3</code>) is a number with
2 digits after decimal point.
</li>
<li><code>\n</code>: Newline
</li>

<li>With printf, no blanks or newlines are produced automatically; you
must create them yourself.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">{ printf("%-8s $%6.2f\n",$1, $2 * $3)}
</pre>
</div>

<pre class="example">
Beth     $  0.00
Dan      $  0.00
Kathy    $ 40.00
Mark     $100.00
Mary     $121.00
Susie    $ 76.50
</pre>


<ul class="org-ul">
<li><code>%-8s</code> Prints a name as a string of characters left justified in a
field 8 characters wide.
</li>
<li><code>%6.2f</code> prints pay as a number with two digits after the decimal
point, in a field 6 characters wide.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2"><span class="section-number-3">7.2</span> Sorting the Output</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">

<pre class="src src-sh">awk '{printf("%6.2f %s\n", $2 * $3, $0)}' emp.data | sort
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="right">

<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-right">0.0</td>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-right">0.0</td>
<td class="text-left">Dan</td>
<td class="text-right">3.75</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-right">100.0</td>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-right">121.0</td>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-right">40.0</td>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-right">76.5</td>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8"><span class="section-number-2">8</span> Selection</h2>
<div class="outline-text-2" id="text-8">
<ul class="org-ul">
<li>Awk patterns are good for selecting interesting lines from the input
for further processing.
</li>
<li>Since a pattern without an action prints all lines matching the
pattern, many awk programs consist of nothing more than a single
pattern.
</li>
</ul>
</div>


<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1"><span class="section-number-3">8.1</span> Selection by Comparison</h3>
<div class="outline-text-3" id="text-8-1">
<ul class="org-ul">
<li>Employees who earn more than or equal to $5 per hour:
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$2 &gt;= 5
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2"><span class="section-number-3">8.2</span> Selection by Computation</h3>
<div class="outline-text-3" id="text-8-2">
<ul class="org-ul">
<li>Employees whose total pay exceeds $50
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$2 * $3 &gt; 50 { printf("$%.2f for %s\n", $2 * $3, $1)}
</pre>
</div>

<pre class="example">
$100.00 for Mark
$121.00 for Mary
$76.50 for Susie
</pre>
</div>
</div>

<div id="outline-container-sec-8-3" class="outline-3">
<h3 id="sec-8-3"><span class="section-number-3">8.3</span> Selection by Text Content</h3>
<div class="outline-text-3" id="text-8-3">
<div class="org-src-container">

<pre class="src src-awk">$1 == "Susie"
</pre>
</div>

<pre class="example">
Susie 4.25   18
</pre>


<ul class="org-ul">
<li>The text pattern can also be regular expressions
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-8-4" class="outline-3">
<h3 id="sec-8-4"><span class="section-number-3">8.4</span> Combinations of Patterns</h3>
<div class="outline-text-3" id="text-8-4">
<ul class="org-ul">
<li>Logical operators can be used: <code>&amp;&amp;, ||</code> and <code>!</code>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$2 &gt;= 4
$3 &gt;= 20
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-awk">!($2 &lt; 4 &amp;&amp; $3 &lt; 20)
</pre>
</div>

<table class="table table-striped table-bordered table-hover table-condensed">


<colgroup>
<col  class="left">

<col  class="right">

<col  class="right">
</colgroup>
<tbody>
<tr>
<td class="text-left">Beth</td>
<td class="text-right">4.0</td>
<td class="text-right">0</td>
</tr>

<tr>
<td class="text-left">Kathy</td>
<td class="text-right">4.0</td>
<td class="text-right">10</td>
</tr>

<tr>
<td class="text-left">Mark</td>
<td class="text-right">5.0</td>
<td class="text-right">20</td>
</tr>

<tr>
<td class="text-left">Mary</td>
<td class="text-right">5.5</td>
<td class="text-right">22</td>
</tr>

<tr>
<td class="text-left">Susie</td>
<td class="text-right">4.25</td>
<td class="text-right">18</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-8-5" class="outline-3">
<h3 id="sec-8-5"><span class="section-number-3">8.5</span> Data validation</h3>
<div class="outline-text-3" id="text-8-5">
<ul class="org-ul">
<li>Awk is an excellent tool for checking that data has reasonable
values and is in the right format, a task that is often called data
validation.
</li>
<li>Data validation is essentially negative: instead of printing lines
with desirable properties, one prints lines that are suspicious.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">NF != 3 { print $0, "number of files is not equal to 3"}
</pre>
</div>

<p>
If there are no errors, there's no output.
</p>

<div class="org-src-container">

<pre class="src src-awk">$2 &gt; 10 { print $0, "rate exceeds $10 per hour"}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8-6" class="outline-3">
<h3 id="sec-8-6"><span class="section-number-3">8.6</span> BEGIN and END</h3>
<div class="outline-text-3" id="text-8-6">
<ul class="org-ul">
<li>The special pattern <b>BEGIN</b> matches before the first line of the first
input ·file is read, and <b>END</b> matches after the last line of the last
file has been processed.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">BEGIN { print "NAME  RATE   HOURS"; print ""}
      { print }
</pre>
</div>

<pre class="example">
NAME  RATE   HOURS

Beth  4.00   0
Dan   3.75   0
Kathy 4.00   10
Mark  5.00   20
Mary  5.50   22
Susie 4.25   18
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9"><span class="section-number-2">9</span> Computing with AWK</h2>
<div class="outline-text-2" id="text-9">
<ul class="org-ul">
<li>An action is a sequence of statements separated by newlines or
semicolons.
</li>
<li>In awk, user-created variables are not declared.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$3 &gt; 15 { emp = emp + 1}
END     { print emp, "employees worked more than 15 hours" }
</pre>
</div>

<pre class="example">
3 employees worked more than 15 hours
</pre>


<ul class="org-ul">
<li>Awk variables used as numbers begin life with the value of <b>0</b>, so
we didn't need to initialize <code>emp</code> above.
</li>
</ul>
</div>

<div id="outline-container-sec-9-1" class="outline-3">
<h3 id="sec-9-1"><span class="section-number-3">9.1</span> Computing Sums and Averages</h3>
<div class="outline-text-3" id="text-9-1">
<ul class="org-ul">
<li>Computing number of employees
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">END { print NR, "employees" }
</pre>
</div>

<pre class="example">
6 employees
</pre>


<ul class="org-ul">
<li>Compute average pay
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">    { pay = pay + $2 * $3 }
END { print NR, "employees" 
      print "total pay is", pay
      print "average pay is", pay/NR
    }
</pre>
</div>

<pre class="example">
6 employees
total pay is 337.5
average pay is 56.25
</pre>
</div>
</div>

<div id="outline-container-sec-9-2" class="outline-3">
<h3 id="sec-9-2"><span class="section-number-3">9.2</span> Handling Text</h3>
<div class="outline-text-3" id="text-9-2">
<ul class="org-ul">
<li>Awk variables can hold strings of characters.
</li>
<li>Variables used to store strings begin life holding the null string.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$2 &gt; maxrate { maxrate = $2; maxemp = $1 }
END { print "highest hourly rate:", maxrate, "for", maxemp }
</pre>
</div>

<pre class="example">
highest hourly rate: 5.50 for Mary
</pre>


<ul class="org-ul">
<li>In the above awk code, the variable <code>maxemp</code> holds a string.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-9-3" class="outline-3">
<h3 id="sec-9-3"><span class="section-number-3">9.3</span> String Concatenation</h3>
<div class="outline-text-3" id="text-9-3">
<ul class="org-ul">
<li>Combine all the employee names into a single string:
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">    { names = names $1 " " }
END { print names }
</pre>
</div>

<pre class="example">
Beth Dan Kathy Mark Mary Susie
</pre>
</div>
</div>

<div id="outline-container-sec-9-4" class="outline-3">
<h3 id="sec-9-4"><span class="section-number-3">9.4</span> Printing the Last Input Line</h3>
<div class="outline-text-3" id="text-9-4">
<div class="org-src-container">

<pre class="src src-awk">    { last = $0 }
END { print last }
</pre>
</div>

<pre class="example">
Susie 4.25   18
</pre>
</div>
</div>

<div id="outline-container-sec-9-5" class="outline-3">
<h3 id="sec-9-5"><span class="section-number-3">9.5</span> Built-in functions</h3>
<div class="outline-text-3" id="text-9-5">
<ul class="org-ul">
<li>Arithematic functions for square roots, logarithms, random numbers etc.
</li>
<li><code>length</code>: Counts the number of characters in a string
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">{ print $1, length($1) }
</pre>
</div>

<pre class="example">
Beth 4
Dan 3
Kathy 5
Mark 4
Mary 4
Susie 5
</pre>
</div>
</div>

<div id="outline-container-sec-9-6" class="outline-3">
<h3 id="sec-9-6"><span class="section-number-3">9.6</span> Counting Lines, Words and Characters</h3>
<div class="outline-text-3" id="text-9-6">
<ul class="org-ul">
<li>In the below program, for convenience we will treat each field as
word.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">    { nc = nc + length($0) + 1 } # 1 for newline
    { nw = nw + NF }
END { print NR, "lines", nw, "words", nc, "characters" }
</pre>
</div>

<pre class="example">
6 lines 18 words 94 characters
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10"><span class="section-number-2">10</span> Control-Flow Statements</h2>
<div class="outline-text-2" id="text-10">
</div><div id="outline-container-sec-10-1" class="outline-3">
<h3 id="sec-10-1"><span class="section-number-3">10.1</span> If-Else Statement</h3>
<div class="outline-text-3" id="text-10-1">
<ul class="org-ul">
<li>Compute total and average pay of employees making more than $6 per
hour.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">$2 &gt; 6 { n = n + 1; pay = pay + $2 * $3 }
END    { if (n &gt; 0)
             print n, "employees total pay is", pay, "average pay is", pay/n
         else
             print "no employees are paid more than $6/hour"
       }
</pre>
</div>

<pre class="example">
no employees are paid more than $6/hour
</pre>
</div>
</div>

<div id="outline-container-sec-10-2" class="outline-3">
<h3 id="sec-10-2"><span class="section-number-3">10.2</span> While Statement</h3>
<div class="outline-text-3" id="text-10-2">
<div class="org-src-container">

<pre class="src src-awk">{ i = 1
  while (i &lt;= $3) {
    printf("\t%.2f\n", $1 * (1 + $2) ^ i)
    i = i + 1
  }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-10-3" class="outline-3">
<h3 id="sec-10-3"><span class="section-number-3">10.3</span> For Statement</h3>
<div class="outline-text-3" id="text-10-3">
<pre class="example">
{ for(i = 1; i &lt;= $3 ; i = i + 1)
     printf("\t%.2f\n", $1 * (1 + $2) ^ i)
}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11"><span class="section-number-2">11</span> Arrays</h2>
<div class="outline-text-2" id="text-11">
<ul class="org-ul">
<li>Arrays are used for storing groups of related values.
</li>
<li>Program to reverse each line
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">    { line[NR] = $0 }               # remember each input line
END { i = NR
      while (i &gt; 0) {
        print line[i]
        i = i - 1
      }
}
</pre>
</div>

<pre class="example">
Susie 4.25   18
Mary  5.50   22
Mark  5.00   20
Kathy 4.00   10
Dan   3.75   0
Beth  4.00   0
</pre>


<p>
Same example with a for statement:
</p>

<div class="org-src-container">

<pre class="src src-awk">    { line[NR] = $0 }
END { for(i = NR; i &gt; 0; i = i - 1)
           print line[i]
    }
</pre>
</div>

<pre class="example">
Susie 4.25   18
Mary  5.50   22
Mark  5.00   20
Kathy 4.00   10
Dan   3.75   0
Beth  4.00   0
</pre>
</div>
</div>


<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12"><span class="section-number-2">12</span> A Handful of Useful "One-liners"</h2>
<div class="outline-text-2" id="text-12">
<ul class="org-ul">
<li>Print total number of input lines
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">END { print NR }
</pre>
</div>

<pre class="example">
6
</pre>


<ul class="org-ul">
<li>Print the third input line
</li>
</ul>

<div class="org-src-container">

<pre class="src src-awk">NR == 3
</pre>
</div>

<pre class="example">
Kathy 4.00   10
</pre>
</div>
</div>
</div></div></div>
<footer id="postamble" class="">
<div><p class="author">Author: Sibi Prabakaran</p>
<p class="date">Created: 2020-11-24 Tue 20:07</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="http://orgmode.org">Org-mode</a> 9.4)</p>
</div>
</footer>
</body>
</html>
